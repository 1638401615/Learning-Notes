## 39.1 文件和目录

* 每个文件都有一个与其关联的 inode 号，inode号是文件的低级名称
* 目录的低级名字是包含一个（用户可读名字，低级名字）对的列表

## 39.2 文件系统接口

* 创建文件：int fd = open("foo", O_CREAT | O_WRONLY | O_TRUNC); 

  open的返回值是**文件描述符**，一个文件描述符就是一种权限，即一个不透明的句柄，他能让你执行某些操作

* 随机搜索：off_t lseek(int fildes, off_t offset, int whence);

* 立即写入fsync()：文件系统通过强制将所有脏（dirty）数据（即尚未写入的）写入磁盘来响应，针对指定文件 ᧿述符引用的文件。一旦所有这些写入完成，fsync()例程就会返回

  >调用write只是告诉文件系统请在将来的某个时刻，将此数据写入持久存储。出于性能的原因，文件系统会将这些写入在内存中缓冲（buffer）一 段时间（例如 5s 或 30s）。在稍后的时间点，写入将实际发送到存储设备。

* 文件重命名：mv

* 要查看特定文件的元数据，我们 可以使用 stat()或 fstat()系统调用。

* 删除文件：rm

* 创建目录：mkdir

* 删除目录：rmdir，要求删除前目录是空的

* 硬链接：”ln 旧路径 新路径“：只是创建了一个新名称，该文件不以任何方式复制

  rm file时，文件系统检查inode引用计数，减一，只有引用计数为0才释放文件	

* 符号链接：用 "ln -s 旧路径 新路径 "。 符号链接与硬链接完全不同，删除名为 file 的原始文件会导致符号链接指向不再存在的路径名，即**悬空引用**

* 搭建和挂载文件系统：mount