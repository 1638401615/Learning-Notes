# 8.1 何为认证

HTTP/1.1 使用的认证方式：

1. BASIC 认证（基本认证）
2. DIGEST 认证（摘要认证）
3. SSL 客户端认证
4. FormBase 认证（基于表单认证）

# 8.2 BASIC 认证

<img src="D:\学习文件\学习笔记\图解http\笔记图片\BASIC认证步骤.jpg" style="zoom:80%;" />

* **用户名和密码两者中间要以冒号（:）连接后，再经过 Base64 编码处理。**图中的用户名和密码都是guest。

* BASIC 认证虽然采用 Base64 编码方式，但这不是加密处理。（所以不安全）

# 8.3 DIGEST 认证

* DIGEST 认证同样使用质询 / 响应的方式，但不会像 BASIC 认证那样直接发送明文密码。

>何为质询 / 响应模式？
>
>所谓质询响应方式是指，一开始一方会先发送认证要求给另一方，接着使用从另一方那接收到的质询码计算生成响应码。最后将响应码返 回给对方进行认证的方式。

<img src="D:\学习文件\学习笔记\图解http\笔记图片\DIGEST认证步骤.jpg" style="zoom:80%;" />

* DIGEST 认证提供防止密码被窃听的保护机制，但并不存在防止用户伪装的保护机制。

# 8.4 SSL 客户端认证

## 8.4.1 SSL 客户端认证的认证步骤

1. 接收到需要认证资源的请求，服务器会发送 Certificate Request 报文，要求客户端提供客户端证书。
2. 用户选择将发送的客户端证书后，客户端会把客户端证书信息以 Client Certificate 报文方式发送给服务器。
3. 服务器验证客户端证书验证通过后方可领取证书内客户端的公开密钥，然后开始 HTTPS 加密通信。

## 8.4.2 SSL 客户端认证采用双因素认证

> 何为双因素认证？
>
> 所谓双因素认证就是指，认证过程中不仅需要密码这一个因素，还需要申请认证者提供其他持有信息，从而作为 另一个因素，与其组合使用的认证方式。
>
> **换言之，第一个认证因素的 SSL客户端证书用来认证客户端计算机，另一个认证因素的密码则用来确定这是用户本人的行为。**

## 8.4.3 SSL 客户端认证必要的费用

* 指买客户端证书的费用以及服务器运营者为保证自己搭建的认证机构安全运营所产生的费用。

# 8.5 基于表单认证

## 8.5.1 认证多半为基于表单认证

DIGEST和BASIC不安全不方便，SSL太贵。

## 8.5.2 Session 管理及 Cookie 应用

在表单认证中，由于HTTP是无状态协议，无法实现状态管理，所以使用 Cookie 来管理 Session，以弥补 HTTP 协议中不存在的状态管理功能。

<img src="D:\学习文件\学习笔记\图解http\笔记图片\Session管理和Cookie状态管理.jpg" style="zoom:80%;" />

* 为了防止Session ID被盗，Session ID 应使用难以推测的字符串，且服务器端也需要进行有效期的管理，保证其安全性。
* 另外，为减轻跨站脚本攻击（XSS）造成的损失，建议事先在 Cookie 内加上 httponly 属性。

> 服务器端应如何保存用户提交的密码？
>
> 一种安全的保存方法是，先利用给密码加盐（salt）的方式增 加额外信息，再使用散列（hash）函数计算出散列值后保存。但是我 们也经常看到直接保存明文密码的做法，而这样的做法具有导致密码 泄露的风险。

> 何为加盐？
>
> salt 其实就是由**服务器随机生成的一个字符串**，但是要保证长度足够长，并且是真正随机生成的。然后把它和密码字符串相连接（前后都可以）生成散列值。当 两个用户使用了同一个密码时，由于随机生成的 salt 值不同，对应的散列值也将是不同的。这样一来，很大程度上减少了密码特征，攻击者也就很难利用自己手中的密码特征库进行破解。